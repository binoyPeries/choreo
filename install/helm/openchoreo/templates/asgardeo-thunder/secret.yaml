{{- if .Values.asgardeoThunder.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "openchoreo-secure-core.fullname" . }}-asgardeo-thunder-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "openchoreo-secure-core.labels" . | nindent 4 }}
    app.kubernetes.io/component: asgardeo-thunder
type: Opaque
data:
  # Backstage Portal OAuth client secret
  {{- if .Values.asgardeoThunder.backstagePortal.enabled }}
  backstage-client-secret: {{ (.Values.asgardeoThunder.backstagePortal.clientSecret | default (randAlphaNum 32)) | b64enc | quote }}
  {{- end }}

  # User passwords
  {{- if .Values.asgardeoThunder.userDetails.users }}
  {{- range $index, $user := .Values.asgardeoThunder.userDetails.users }}
  user-password-{{ $user.username }}: {{ $user.password | b64enc | quote }}
  {{- end }}
  {{- end }}
{{- end }}
